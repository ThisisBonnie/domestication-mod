# Need to overide the first contact stages to include cases for the domesticator civic. Will have to reaserch alternate ways implement this in the future
# TODO: write custom events specific for civic in:
# default_hostile_ship_stage  
# hostile_first_contact_attempted


# Overiding the base_contact_set to add civic specific summary
base_contact_set = {
	icon = GFX_firstcontact_icon_starter
	picture = GFX_evt_star_chart
	difficulty = 2

	stage_event = {
		summary =  fcsum_base_contact_set_summary
		event_weight = {
			weight = 10
			modifier = {
                factor = 0
                this.owner = {
            	        is_domesticator_or_protectorate = no
                    }    
                }
		}
		event = first_contact.1 #country event for owner of first contact site
	}
    stage_event = {
        summary = fcsum_base_contact_domesticators_summary
        event_weight = { 
           weight = 0
            modifier = {
                weight = 10
                this.owner = {
            	        is_domesticator_or_protectorate = yes
                    }    
                }
        }
        event = first_contact.1 #country event for owner of first contact site
    }

	on_roll_failed = {
		#nah
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = no_events }
        
	}
}

# default empires - start off event
default_stage_1 = {
	icon = GFX_firstcontact_icon_progress
	picture = GFX_evt_star_chart

	difficulty = 5

	stage_event = { # no inhabited systems known
		summary = fcsum_stage_1_summary
		event_weight = {
			weight = 10
			modifier = {
				factor = 0
				contact_country = {
					any_system_within_border = {
						root.owner = {
							intel_level = {
								level > low
								system = prev
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					any_owned_fleet = {
						is_within_borders_of = root.owner
					}
				}
			}
		}
		event = first_contact.5
	}

	stage_event = { # no inhabited systems known, they are scanning us
		summary = fcsum_stage_1_summary
		event_weight = {
			weight = 10
			modifier = {
				factor = 0
				contact_country = {
					any_system_within_border = {
						root.owner = {
							intel_level = {
								level > low
								system = prev
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					contact_country = {
						any_owned_fleet = {
							is_within_borders_of = root.owner
						}
					}
				}
			}
		}
		event = first_contact.10
	}

	stage_event = { # inhabited systems known
		summary = fcsum_stage_1_summary
		event_weight = {
			weight = 10
			modifier = {
				factor = 0
				NOT = {
					contact_country = {
						any_system_within_border = {
							root.owner = {
								intel_level = {
									level > low
									system = prev
								}
							}
						}
					}
				}
			}
		}
		event = first_contact.15
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = early_fc_random_events }
	}
}

# default empires - event for setting up the story
# Disabled the other story line events for now. Will add unique versions of the events later
# Speaking in Riddles, Monstrous Noises, Apparent Hostility, Hummers and Octopodes stories
default_stage_2 = {
	picture = GFX_evt_mysterious_signal
	difficulty = 7

	# standard non-proactive
	stage_event = {
		icon = GFX_firstcontact_icon_question
		summary = fcsum_investigation_needed
		event_weight = {
			weight = 0
			modifier = {
				weight = 100
				contact_country = {
					NOT = { has_policy_flag = first_contact_proactive }
				}
			}
		}
		event = first_contact.50
	}

	# standard proactive
	stage_event = {
		icon = GFX_firstcontact_icon_success
		summary = fcsum_comms_received
		event_weight = {
			weight = 0
			modifier = {
				weight = 100
				contact_country = {
					has_policy_flag = first_contact_proactive
				}
			}
		}
		event = first_contact.60
	}

	# first encounter hive->default
	stage_event = {
		icon = GFX_firstcontact_icon_progress
		summary = fcsum_hive_to_default_1
		event_weight = {
			weight = 0
			modifier = {
				weight = 10000
				contact_country = {
					is_regular_empire = yes
				}
				owner = {
					is_hive_empire = yes
					NOT = { has_country_flag = hive_encountered_default }
					NOT = {
						any_relation = {
							is_regular_empire = yes
							has_communications = prev
						}
					}
				}
			}
		}
		event = first_contact.380
	}

	# first encounter machine->default
	stage_event = {
		icon = GFX_firstcontact_icon_progress
		summary = fcsum_machine_to_default_1
		event_weight = {
			weight = 0
			modifier = {
				weight = 10000
				owner = { is_machine_empire = yes }
				OR = {
					AND = {
						contact_country = {
							is_regular_empire = yes
						}
						owner = {
							NOT = { has_country_flag = machine_encountered_default }
							NOT = {
								any_relation = {
									is_regular_empire = yes
									has_communications = prev
								}
							}
						}
					}
					AND = {
						contact_country = {
							is_hive_empire = yes
						}
						owner = {
							NOT = { has_country_flag = machine_encountered_hive }
							NOT = {
								any_relation = {
									is_hive_empire = yes
									has_communications = prev
								}
							}
						}
					}
				}
			}
		}
		event = first_contact.390
	}

	# Speaking in Riddles story
	stage_event = {
		icon = GFX_firstcontact_icon_question
		summary = fcsum_riddles_1
		event_weight = {
			weight = 5
			modifier = {
				factor = 0
				owner = {
					OR = {
						has_country_flag = first_contact_speaking_in_riddles_chain
						AND = {
							is_gestalt = yes
							any_relation = {
								has_communications = prev
								is_regular_empire = yes
							}
						}
						is_homicidal = yes
					}
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					OR = {
						is_homicidal = yes
						is_gestalt = yes
					}
				}
			}
		}
		event = first_contact.350
	}

	# Monstrous Noises story
	stage_event = {
		icon = GFX_firstcontact_icon_warship_progress
		summary = fcsum_monstrous_noises_1
		event_weight = {
			weight = 5
			modifier = {
				factor = 0
				owner = {
					OR = {
						has_country_flag = first_contact_monstrous_noises_chain
						is_gestalt = yes
						is_homicidal = yes
					}
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					is_gestalt = yes
				}
			}
			modifier = {
				factor = 2.5
				contact_country = {
					is_militarist = yes
				}
			}
			modifier = {
				factor = 4
				contact_country = {
					OR = {
						has_ai_personality = honorbound_warriors
						has_valid_civic = civic_fanatic_purifiers
					}
				}
			}
		}
		event = first_contact.365
	}

	# Apparent Hostility story
	# Disabled for domesticators
	stage_event = {
		icon = GFX_firstcontact_icon_warship_progress
		summary = fcsum_apparent_hostility_1
		event_weight = {
			weight = 5
			modifier = {
				factor = 0
				owner = {
					OR = {
						is_domesticator_or_protectorate = yes
						has_country_flag = first_contact_apparent_hostility_chain
					}
					
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					is_militarist = no
					NOT = { has_ai_personality = honorbound_warriors }
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					is_hostile_to = root.owner
				}
			}
			modifier = {
				factor = 3
				contact_country = {
					OR = {
						has_ai_personality = honorbound_warriors
						has_valid_civic = civic_fanatic_purifiers
					}
				}
			}
		}
		event = first_contact.400
	}

	# Hummers story
	# Disabled for domesticators
	stage_event = {
		icon = GFX_firstcontact_icon_question
		summary = fcsum_hummers_1
		event_weight = {
			weight = 10
			modifier = {
				factor = 0
				owner = {
					OR = {
						is_gestalt = yes #no part of it would work, sadly...
						has_country_flag = first_contact_hummers_chain
						NOR = { #noobs not allowed
							has_modifier = first_contact_skill_1
							has_modifier = first_contact_skill_2
							has_modifier = first_contact_skill_3
							has_modifier = first_contact_skill_4
						}
						is_domesticator_or_protectorate = yes
					}
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					is_gestalt = yes
				}
			}
			modifier = {
				factor = 0.5
				contact_country = {
					is_same_species_class = root.owner
				}
			}
		}
		event = first_contact.415
	}

	# Octopodes story
	# Disabled for domesticators
	stage_event = {
		icon = GFX_firstcontact_icon_question
		summary = fcsum_octopodes_1
		event_weight = {
			weight = 2
			modifier = {
				factor = 0
				owner = {
					OR = {
						has_country_flag = first_contact_octopodes_chain
						NOR = { #noobs not allowed
							has_modifier = first_contact_skill_1
							has_modifier = first_contact_skill_2
							has_modifier = first_contact_skill_3
							has_modifier = first_contact_skill_4
						}
						is_domesticator_or_protectorate = yes
					}
				}
			}
			modifier = {
				factor = 0
				contact_country = {
					is_gestalt = yes
				}
			}
			modifier = {
				factor = 8
				contact_country = {
					OR = {
						is_species_class = AQUATIC
						is_species_class = MOL
					}
				}
			}
		}
		event = first_contact.430
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = early_fc_random_events }
	}
}


# default empires - you tried to hack them, see if you succeeded
default_hacking_stage_main = {
	picture = GFX_evt_spymaster

	difficulty = 7

	# success, undetected
	stage_event = {
		icon = GFX_firstcontact_icon_success
		summary = fcsum_hacking_best
		event_weight = {
			weight = 1
			modifier = {
				factor = 1.33
				contact_country = {
					has_policy_flag = first_contact_proactive
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio >= 1.2
					}
				}
			}
		}
		event = first_contact.200
	}
	# success, detected
	stage_event = {
		icon = GFX_firstcontact_icon_success
		summary = fcsum_hacking_decent
		event_weight = {
			weight = 1
			modifier = {
				factor = 1.33
				contact_country = {
					has_policy_flag = first_contact_proactive
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio >= 1.2
					}
				}
			}
		}
		event = first_contact.205
	}
	# failure, undetected (incapable but careful)
	stage_event = {
		icon = GFX_firstcontact_icon_fail
		summary = fcsum_hacking_fail
		event_weight = {
			weight = 1
			modifier = {
				factor = 1.2
				contact_country = {
					has_policy_flag = first_contact_cautious
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio <= 0.8
					}
				}
			}
			modifier = {
				factor = 0.9
				owner = {
					has_modifier = first_contact_skill_2
				}
			}
			modifier = {
				factor = 0.8
				owner = {
					has_modifier = first_contact_skill_3
				}
			}
			modifier = {
				factor = 0.6
				owner = {
					has_modifier = first_contact_skill_4
				}
			}
		}
		event = first_contact.210
	}
	# failure, detected (foiled)
	stage_event = {
		icon = GFX_firstcontact_icon_fail
		summary = fcsum_hacking_fail
		event_weight = {
			weight = 1
			modifier = {
				factor = 1.2
				contact_country = {
					has_policy_flag = first_contact_cautious
				}
			}
			modifier = {
				factor = 1.5
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio <= 0.8
					}
				}
			}
			modifier = {
				factor = 0.9
				owner = {
					has_modifier = first_contact_skill_2
				}
			}
			modifier = {
				factor = 0.8
				owner = {
					has_modifier = first_contact_skill_3
				}
			}
			modifier = {
				factor = 0.6
				owner = {
					has_modifier = first_contact_skill_4
				}
			}
		}
		event = first_contact.215
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}

# hacking end stage
default_end_stage_hacking = {
	icon = GFX_firstcontact_icon_success
	picture = GFX_evt_spymaster

	difficulty = 1 #easy peasy

	stage_event = {
		summary = fcsum_comms_established
		event_weight = {
			weight = 10
		}
		event = first_contact.220
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = late_fc_random_events }
	}
}

# Hostile Chain

# default empires - you tried to steal their ship, see if you succeeded
default_hostile_ship_stage = {
	picture = GFX_evt_face_off_in_space

	difficulty = 2

	# You capture them and their ship alive (best)
	stage_event = {
		icon = GFX_firstcontact_icon_warship_success
		summary = fcsum_hostile_ship_best
		event_weight = {
			weight = 2
			modifier = {
				factor = 0
				first_contact_can_capture_ship = no
			}
			modifier = {
				factor = 0.5
				NOT = {
					contact_country = {
						any_owned_fleet = {
							is_within_borders_of = root.owner
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				contact_country = {
					is_gestalt = yes
				}
			}
			modifier = {
				factor = 1.5
				contact_country = {
					has_policy_flag = first_contact_proactive
				}
			}
			modifier = {
				factor = 1.2
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio >= 1.2
					}
				}
			}
			modifier = {
				factor = 1.1
				owner = {
					has_modifier = first_contact_skill_2
				}
			}
			modifier = {
				factor = 1.2
				owner = {
					has_modifier = first_contact_skill_3
				}
			}
			modifier = {
				factor = 1.3
				owner = {
					has_modifier = first_contact_skill_4
				}
			}
		}
		event = first_contact.250
	}

	# You capture the ship intact but no living hostages, computer systems intact
	stage_event = {
		icon = GFX_firstcontact_icon_warship_progress
		summary = fcsum_hostile_ship_none_alive
		event_weight = {
			weight = 1
			modifier = {
				factor = 0
				first_contact_can_capture_ship = no
			}
			modifier = {
				factor = 0.5
				NOT = {
					contact_country = {
						any_owned_fleet = {
							is_within_borders_of = root.owner
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				contact_country = {
					has_policy_flag = first_contact_proactive
				}
			}
		}
		event = first_contact.260
	}

	# You accidentally destroy the ship
	stage_event = {
		icon = GFX_firstcontact_icon_fail
		summary = fcsum_hostile_ship_none_destroyed
		event_weight = {
			weight = 1
			modifier = {
				factor = 0
				first_contact_can_capture_ship = no
			}
			modifier = {
				factor = 0.9
				owner = {
					has_modifier = first_contact_skill_2
				}
			}
			modifier = {
				factor = 0.8
				owner = {
					has_modifier = first_contact_skill_3
				}
			}
			modifier = {
				factor = 0.7
				owner = {
					has_modifier = first_contact_skill_4
				}
			}
		}
		event = first_contact.270
	}

	# failure, they escaped
	stage_event = {
		icon = GFX_firstcontact_icon_fail
		summary = fcsum_hostile_ship_escaped
		event_weight = {
			weight = 1
			modifier = {
				factor = 2
				contact_country = {
					NOT = {
						any_owned_fleet = {
							is_civilian = yes
							is_within_borders_of = root.owner
						}
					}
				}
			}
			modifier = {
				factor = 1.33
				contact_country = {
					has_policy_flag = first_contact_cautious
				}
			}
			modifier = {
				factor = 1.2
				owner = {
					tech_unlocked_ratio = {
						who = root.contact_country
						ratio <= 0.8
					}
				}
			}
			modifier = {
				factor = 0.9
				owner = {
					has_modifier = first_contact_skill_2
				}
			}
			modifier = {
				factor = 0.8
				owner = {
					has_modifier = first_contact_skill_3
				}
			}
			modifier = {
				factor = 0.7
				owner = {
					has_modifier = first_contact_skill_4
				}
			}
		}
		event = first_contact.280
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}

# hostile interrogation end stage
default_end_stage_hostile_with_crew = {
	icon = GFX_firstcontact_icon_success
	picture = GFX_evt_inhabited_solar_system

	difficulty = 2 #easy

	stage_event = {
		summary = fcsum_interrogation_ended
		event_weight = {
			weight = 10
		}
		event = first_contact.285
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}

# hostile interrogation end stage
default_end_stage_hostile_with_crew_easy = {
	icon = GFX_firstcontact_icon_success
	picture = GFX_evt_inhabited_solar_system

	difficulty = 0 #really easy

	stage_event = {
		summary = fcsum_interrogation_ended
		event_weight = {
			weight = 10
		}
		event = first_contact.285
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}

# hostile interrogation end stage
default_end_stage_hostile_with_crew_hard = {
	icon = GFX_firstcontact_icon_success
	picture = GFX_evt_inhabited_solar_system

	difficulty = 5 #less easy

	stage_event = {
		summary = fcsum_interrogation_ended
		event_weight = {
			weight = 10
		}
		event = first_contact.285
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}

# hostile interrogation end stage
default_end_stage_hostile_no_crew = {
	icon = GFX_firstcontact_icon_success
	picture = GFX_evt_ancient_databank

	difficulty = 5

	stage_event = {
		summary = fcsum_comms_established
		event_weight = {
			weight = 10
		}
		event = first_contact.295
	}

	on_roll_failed = {
		standard_first_contact_on_roll_failed = { RANDOM_EVENTS = hostile_fc_random_events }
	}
}